# Apache Virtual Hosts Configuration
# Place in: /etc/apache2/sites-available/vhosts.conf

# HTTP Virtual Host
<VirtualHost *:80>
    ServerAdmin admin@example.com
    ServerName example.com
    ServerAlias www.example.com
    
    DocumentRoot /var/www/html/website
    
    <Directory /var/www/html/website>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # PHP Settings
        php_admin_value upload_max_filesize 256M
        php_admin_value post_max_size 256M
        php_admin_value memory_limit 512M
        php_admin_value max_execution_time 300
    </Directory>
    
    # Logging
    ErrorLog ${APACHE_LOG_DIR}/example-error.log
    CustomLog ${APACHE_LOG_DIR}/example-access.log combined
    
    # Security Headers
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "no-referrer-when-downgrade"
    
    # Compression
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/html text/plain text/xml text/css
        AddOutputFilterByType DEFLATE application/javascript application/json
    </IfModule>
    
    # Browser Caching
    <IfModule mod_expires.c>
        ExpiresActive On
        ExpiresByType image/jpg "access plus 1 year"
        ExpiresByType image/jpeg "access plus 1 year"
        ExpiresByType image/gif "access plus 1 year"
        ExpiresByType image/png "access plus 1 year"
        ExpiresByType image/svg+xml "access plus 1 year"
        ExpiresByType text/css "access plus 1 month"
        ExpiresByType application/javascript "access plus 1 month"
        ExpiresByType application/pdf "access plus 1 month"
        ExpiresByType image/x-icon "access plus 1 year"
    </IfModule>
    
    # Deny access to hidden files
    <FilesMatch "^\.">
        Require all denied
    </FilesMatch>
    
    # Protect sensitive files
    <FilesMatch "(^#.*#|\.(bak|conf|dist|fla|in[ci]|log|psd|sh|sql|sw[op])|~)$">
        Require all denied
    </FilesMatch>
</VirtualHost>

# WordPress Virtual Host
<VirtualHost *:80>
    ServerAdmin admin@wordpress.local
    ServerName wordpress.local
    ServerAlias www.wordpress.local
    
    DocumentRoot /var/www/html/wordpress
    
    <Directory /var/www/html/wordpress>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
        
        # WordPress specific settings
        <IfModule mod_rewrite.c>
            RewriteEngine On
            RewriteBase /
            RewriteRule ^index\.php$ - [L]
            RewriteCond %{REQUEST_FILENAME} !-f
            RewriteCond %{REQUEST_FILENAME} !-d
            RewriteRule . /index.php [L]
        </IfModule>
    </Directory>
    
    # Deny access to wp-config.php
    <Files wp-config.php>
        Require all denied
    </Files>
    
    # Protect uploads directory
    <Directory /var/www/html/wordpress/wp-content/uploads>
        <FilesMatch "\.php$">
            Require all denied
        </FilesMatch>
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/wordpress-error.log
    CustomLog ${APACHE_LOG_DIR}/wordpress-access.log combined
</VirtualHost>

# SSL Virtual Host Template (uncomment after SSL setup)
# <VirtualHost *:443>
#     ServerAdmin admin@example.com
#     ServerName example.com
#     ServerAlias www.example.com
#     
#     DocumentRoot /var/www/html/website
#     
#     SSLEngine on
#     SSLCertificateFile /etc/ssl/certs/example.com.crt
#     SSLCertificateKeyFile /etc/ssl/private/example.com.key
#     SSLCertificateChainFile /etc/ssl/certs/chain.crt
#     
#     SSLProtocol all -SSLv3 -TLSv1 -TLSv1.1
#     SSLCipherSuite HIGH:!aNULL:!MD5
#     SSLHonorCipherOrder on
#     
#     <Directory /var/www/html/website>
#         Options -Indexes +FollowSymLinks
#         AllowOverride All
#         Require all granted
#     </Directory>
#     
#     ErrorLog ${APACHE_LOG_DIR}/example-ssl-error.log
#     CustomLog ${APACHE_LOG_DIR}/example-ssl-access.log combined
# </VirtualHost>